<!--
  <mat-spinner *ngIf="spinnerLoading"></mat-spinner>
  <mat-card class="example-full-width" *ngIf="!spinnerLoading">
-->

<mat-card class="example-full-width" >

<mat-tab-group mat-align-tabs="center"  (selectedTabChange)="profileTabSelected($event)">
  <mat-tab>
    <ng-template mat-tab-label>
      <mat-icon class="example-tab-icon"><i class="fas fa-id-card"></i></mat-icon>
      Profile
    </ng-template>

    <mat-card class="cust-container" >
    <mat-card-title>CRM Personal Data</mat-card-title>

    <form [formGroup]="personalForm"   >

      <mat-form-field class="col-md-6">
        <input id="FirstName" name="FirstName" matInput  formControlName="FirstName" [(ngModel)]="personal.FirstName" placeholder="FirstName" required >
        <mat-error *ngIf="personalForm.get('FirstName').invalid" >Please fill First Name.</mat-error>
      </mat-form-field>

      <mat-form-field class="col-md-6">
        <mat-label>LastName</mat-label>
        <input matInput formControlName="LastName" [(ngModel)]="personal.LastName" placeholder="LastName" required >
      </mat-form-field>

      <mat-form-field class="col-md-6">
        <mat-label>CustomerAlias</mat-label>
        <input matInput formControlName="CustomerAlias" [(ngModel)]="personal.CustomerAlias"  placeholder="CustomerAlias" >
      </mat-form-field>

      <mat-form-field class="col-md-6">
        <mat-label>วันเกิด</mat-label>
        <input matInput  [matDatepicker]="Dob" formControlName="Dob" [(ngModel)]="personal.Dob"
          placeholder="DOB"
          [readonly]="true" >
        <mat-datepicker-toggle matSuffix [for]="Dob"></mat-datepicker-toggle>
        <mat-datepicker #Dob disabled="false"></mat-datepicker>
      </mat-form-field>

      <mat-label>Sex</mat-label>
      <section  class="example-full-width" >
          <mat-radio-group  formControlName="Sex" [(ngModel)]="personal.Sex">
            <mat-radio-button class="example-margin"  *ngFor="let obj of SexList" [value]="obj.code">{{obj.text}}</mat-radio-button>
          </mat-radio-group>
      </section>

      <mat-form-field class="col-md-6">
        <mat-label>Mobile</mat-label>
        <input matInput formControlName="Mobile" [(ngModel)]="personal.Mobile" #Mobile required>
        <mat-hint align="end">{{Mobile.value.length}} / 10</mat-hint>
      </mat-form-field>

      <mat-form-field class="col-md-6">
        <mat-label>Telephone
        </mat-label>
        <input matInput formControlName="Telephone" [(ngModel)]="personal.Telephone" >
      </mat-form-field>

      <div>
        <!-- Email -->
        <mat-form-field class="col-md-6">
          <mat-label>Email</mat-label>
          <input type="email" matInput formControlName="Email" [(ngModel)]="personal.Email" >
          <mat-hint>jhone@gmail.com</mat-hint>
        </mat-form-field>

        <!-- SocialAccount -->
        <mat-form-field class="col-md-6">
          <mat-label>SocialAccount</mat-label>
          <input matInput formControlName="SocialAccount" [(ngModel)]="personal.SocialAccount"  >
          <mat-hint >FC, LinkIn, Line</mat-hint>
        </mat-form-field>

      </div>

      <div>
        <h3>Important data</h3>
        <mat-form-field class="col-md-6">
          <textarea matInput formControlName="ImportantData" [(ngModel)]="personal.ImportantData" rows=5></textarea>
          <mat-hint >Something is special data for customer</mat-hint>
        </mat-form-field>
      </div>

      <div>
        <h2>Invest Info</h2>
      </div>

      <!-- Refer -->
      <mat-form-field class="col-md-6">
        <mat-label>Referral</mat-label>
        <mat-select formControlName="Refer" [(ngModel)]="personal.Refer" >
            <mat-option  *ngFor="let obj of ReferList" [value]="obj.code">
              {{obj.text}}
            </mat-option>
          </mat-select>
      </mat-form-field>

      <div>
        <mat-label>สถานะลูกค้า</mat-label>
        <section class="example-full-width">
          <mat-radio-group formControlName="State" [(ngModel)]="personal.State">
            <mat-radio-button class="example-margin"  *ngFor="let obj of stateList" [value]="obj.code">{{obj.text}}</mat-radio-button>
          </mat-radio-group>
        </section>
      </div>

      <mat-label>ประเภทของลูกค้า</mat-label>
      <section class="example-full-width">
        <mat-radio-group formControlName="Type" [(ngModel)]="personal.custType" >
          <mat-radio-button class="example-margin"  *ngFor="let obj of custTypeList" [value]="obj.code">{{obj.text}}</mat-radio-button>
        </mat-radio-group>
      </section>

       <!-- Class -->
       <mat-label>Class</mat-label>
       <section class="example-full-width">
         <mat-radio-group  formControlName="Class" [(ngModel)]="personal.Class" >
           <mat-radio-button class="example-margin"  *ngFor="let obj of ClassList" [value]="obj.code">{{obj.text}}</mat-radio-button>
         </mat-radio-group>
       </section>

      <!-- Interested -->
      <mat-form-field class="col-md-6">
        <mat-label>Interested</mat-label>
        <mat-select multiple formControlName="Interested" [(ngModel)]="personal.Interested" >
            <mat-option  *ngFor="let obj of interestList" [value]="obj.code">
              {{obj.text}}
            </mat-option>
          </mat-select>
        <!-- <mat-error *ngIf="form.get('status').invalid">Please choose status.</mat-error> -->
      </mat-form-field>

      <div>
        <!-- <mat-form-field class="col-md-6">
          <mat-label>Source of data</mat-label>
          <mat-select formControlName="SourceOfCustomer" [(ngModel)]="personal.SourceOfCustomer">
              <mat-option  *ngFor="let obj of SourceOfCustomerList" [value]="obj.code">
                {{obj.desc}}
              </mat-option>
            </mat-select>
            <mat-hint>Accetpt by</mat-hint>
        </mat-form-field> -->

        <!-- UserOwner -->
        <!-- <mat-form-field class="col-md-6">
          <mat-label>UserOwner
          </mat-label>
          <input matInput  disabled  [(ngModel)]="personal.UserOwner" [ngModelOptions]="{standalone: true}">
          <mat-hint>Marketing</mat-hint>
        </mat-form-field>
         -->
      </div>

      <!-- InvestCondition -->
      <mat-form-field class="col-md-6" >
        <mat-label>InvestCondition </mat-label>
        <textarea matInput rows="3" formControlName="InvestCondition" [(ngModel)]="personal.InvestCondition" rows="5"></textarea>
      </mat-form-field>

      <div>
        UserOwner {{personal.UserOwner}}
      </div>


      <mat-card-actions>
        <a mat-flat-button class="button_card_action" color="primary" (click)="onPersonFormSubmit()"  >SAVE</a>
        <!-- <a  class="button_card_action" mat-flat-button color="primary"  (click)="goBack()"> BACK</a> -->
      <button mat-flat-button class="button_card_action"color="warn" type='reset' *ngIf="!isDisableFields">Reset</button>

      </mat-card-actions>

    </form>

    </mat-card>

  </mat-tab>
  <mat-tab>
    <ng-template mat-tab-label>
      <mat-icon class="example-tab-icon"><i class="fas fa-money-check-alt"></i></mat-icon>
      Portfolio 2
    </ng-template>

    <div class="div_top10">
      <app-crm-portfolio [custCode]="personal.CustCode" ></app-crm-portfolio>
      <!-- <app-crm-portfolio [custCode]="personal.CustCode" ></app-crm-portfolio> -->
    </div>
  </mat-tab>

  <mat-tab>
    <ng-template mat-tab-label>
      <mat-icon class="example-tab-icon"><i class="fas fa-history"></i></mat-icon>
      Timeline
    </ng-template>

    <div class="div_top10">
      <app-crm-timeline [personal]="personal" ></app-crm-timeline>
      <!-- <app-crm-portfolio [custCode]="personal.CustCode" ></app-crm-portfolio> -->
    </div>

  </mat-tab>
  <mat-tab>
    <ng-template mat-tab-label>
      <mat-icon class="example-tab-icon"><i class="fas fa-history"></i></mat-icon>
      PDPA Consent
    </ng-template>
    <h3>Consents </h3>

    <table mat-table [dataSource]="consent_dataSource" class="col-md-6">

      <ng-container matColumnDef="topic">
        <th mat-header-cell *matHeaderCellDef> Topic </th>
        <td mat-cell *matCellDef="let element"> {{element.topic}} </td>
      </ng-container>

        <ng-container matColumnDef="submitDate">
          <th mat-header-cell *matHeaderCellDef> Submit Date </th>
          <td mat-cell *matCellDef="let element">{{element.submitDate}} </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef> Status </th>
          <td mat-cell *matCellDef="let element">{{element.status}} </td>
        </ng-container>
        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef> Action </th>
          <td mat-cell *matCellDef="let element">
            <a > Edit </a>
            <a > Cancel </a>

          </td>
        </ng-container>

      <tr mat-header-row *matHeaderRowDef="consent_displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: consent_displayedColumns;"></tr>
    </table>

  </mat-tab>
</mat-tab-group>

</mat-card>
