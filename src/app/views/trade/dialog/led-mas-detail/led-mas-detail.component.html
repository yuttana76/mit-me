
  <div class="container ">
        <mat-card-title>LED detail</mat-card-title>
          <form [formGroup]="form"  >
            <div class="row">
            <mat-form-field class="col-md-4" >
                <input   matInput formControlName="twsid" placeholder=" twsid"
                [(ngModel)]="mitLedMas.twsid">
            </mat-form-field>

            <mat-form-field class="col-md-4">
                <input   matInput formControlName="cust_code" placeholder="ID"
                [(ngModel)]="mitLedMas.df_id">
            </mat-form-field>
            </div>

            <div class="row">
            <mat-form-field class="col-md-4">
                <input   matInput formControlName="firstName" placeholder="First Name"
                [(ngModel)]="mitLedMas.df_name">
            </mat-form-field>

            <mat-form-field class="col-md-4">
                <input   matInput formControlName="lastName" placeholder=" Last Name"
                [(ngModel)]="mitLedMas.df_surname">
            </mat-form-field>
            </div>

            <div class="row">
              <mat-form-field class="col-md-4">
                <mat-select  formControlName="led_code" placeholder="LED code"
                [(ngModel)]="mitLedMas.led_code">
                    <mat-option  *ngFor="let obj of codeLookupList" [value]="obj.keycode">
                      {{obj.keyText}}
                    </mat-option>
                  </mat-select>
                <mat-error *ngIf="form.get('led_code').invalid">Choose one</mat-error>
            </mat-form-field>
            </div>

            <div *ngIf="editMasFlag" class="row" >
              <a *ngIf="authority.mEdit == YES_VAL"  mat-flat-button color="primary"  (click)="saveMas()"> SAVE MAS</a>
              <a *ngIf="authority.mEdit == YES_VAL"  mat-flat-button  color="accent" (click)="saveMasClear()"> CANCEL</a>
            </div>


          </form>

          <!-- Add new history -->
            <div *ngIf="new_mitLedMasHis" >

                <mat-card-title *ngIf="!new_mitLedMasHis.no">Add history  </mat-card-title>
                <mat-card-title *ngIf="new_mitLedMasHis.no" >Edit history  </mat-card-title>

                <form [formGroup]="addHistForm"   >

                    <div class='row  '>
                    <mat-form-field class="col-md-6">
                        <mat-select  formControlName="led_state" placeholder="State"
                        [(ngModel)]="new_mitLedMasHis.led_state">
                            <mat-option  *ngFor="let obj of codeLookupList" [value]="obj.keycode">
                             {{obj.keyText}}
                            </mat-option>
                          </mat-select>
                        <mat-error *ngIf="addHistForm.get('led_state').invalid">Choose one</mat-error>
                    </mat-form-field>
                  </div>

                  <div class='row '>
                      <mat-form-field class="col-md-8">
                          <textarea matInput placeholder="Memo" formControlName="memo" [(ngModel)]="new_mitLedMasHis.memo" rows=5 ></textarea>
                          <mat-error *ngIf="addHistForm.get('memo').invalid">Please enter Memo</mat-error>
                      </mat-form-field>
                  </div>

                  <div class='row '>
<!--
                        <mat-form-field >
                            <input  id="input_resourceRef" matInput formControlName="resourceRef" placeholder=" Reference source"
                            [(ngModel)]="new_mitLedMasHis.resourceRef" readonly=true >
                            <mat-error *ngIf="addHistForm.get('resourceRef').invalid">Please enter reference source</mat-error>
                        </mat-form-field> -->

                        <div>
                          <p>{{new_mitLedMasHis.resourceRef}}</p>

                          <span *ngIf="new_mitLedMasHis.resourceRef" >
                                <i *ngIf="new_mitLedMasHis.resourceExt === 'pdf'"  class="far fa-2x fa-file-pdf" ></i>
                                <i *ngIf="new_mitLedMasHis.resourceExt === 'zip'"  class="far fa-2x fa-file-archive" ></i>
                                <i *ngIf="new_mitLedMasHis.resourceExt === 'png' ||  new_mitLedMasHis.resourceExt === 'jpg' " class="far fa-2x fa-file-image" ></i>
                        </span>


                          <i id="delResourceRef" *ngIf="new_mitLedMasHis.resourceRef && authority.mEdit == YES_VAL " class="fas fa-2x fa-trash-alt" (click)="onRemoveHist()" matTooltip= "ลบ" ></i>

                          <button id="btnResourceRef" *ngIf="!new_mitLedMasHis.resourceRef && authority.mEdit == YES_VAL" mat-stroked-button type="button" (click)="filePicker.click()">Pick Image</button>
                          <input type="file" #filePicker (change)="onResourcePicked($event)">
                    </div>
                  </div>

                  <div class="row"  >
                      <mat-card-actions>
                          <a *ngIf="authority.mEdit == YES_VAL"  mat-flat-button class="button_card_action" color="primary" (click)="onSave()"  >Save</a>
                          <a  mat-flat-button class="button_card_action" color="accent" (click)="onNewHisCancel()"  >Cancel</a>
                      </mat-card-actions>
                  </div>

                </form>
            </div>

            <!-- List all history -->
            <div *ngIf="!new_mitLedMasHis"  class="panel-body">
            <mat-card-title>List history  </mat-card-title>
            <mat-card  *ngFor="let item of masHistory; let i = index" >

                <!-- <div mat-card-avatar class="example-header-image"></div> -->

                <mat-card-title>{{item.led_state_txt}}

                  <span *ngIf="item.resourceRef"  class="his_ref">
                        <a [href]="item.resourceRef"  target="_blank" >
                          <i *ngIf="item.resourceExt === 'pdf'"  class="far  fa-file-pdf" ></i>
                          <i *ngIf="item.resourceExt === 'zip'"   class="far  fa-file-archive" ></i>
                          <i *ngIf="item.resourceExt === 'png' ||  item.resourceExt === 'jpg' "  class="far  fa-file-image" ></i>
                        </a>
                  </span>

                </mat-card-title>

                <mat-card-subtitle>
                  <span class="row text-muted">
                      <p class="pull-left">Create By
                          <strong class="text-success "> {{item.createBy}}</strong>
                      </p>
                      <small class="his_time">{{item.createDate | date: 'dd/MM/yyyy h:mm a'}}</small>
                  </span>

                  <span *ngIf="item.updateBy" class="row text-muted">
                      <p class="pull-left">Update By
                          <strong class="text-success">{{item.updateBy}}</strong>
                      </p>
                      <small class="his_time" >{{item.updateDate | date: 'dd/MM/yyyy h:mm a'}}</small>
                  </span>
                </mat-card-subtitle>

              <!-- <img mat-card-image src="https://material.angular.io/assets/img/examples/shiba2.jpg" alt="Photo of a Shiba Inu"> -->
              <mat-card-content>
                <p>
                    {{item.memo}}
                </p>
              </mat-card-content>
              <!-- <mat-card-actions>
                <button  mat-stroked-button color="warn" (click)="editHistory(item)" >Edit</button>
              </mat-card-actions> -->
            </mat-card>
          </div>



          <div *ngIf="showActionBar" class="panel-buttom">
              <a *ngIf="authority.mEdit == YES_VAL" id ="new_his"  mat-flat-button color="primary"  (click)="addHistory()"> Add  HIS </a>
              <a *ngIf="authority.mEdit == YES_VAL" id ="new_his"  mat-flat-button color="accent"  (click)="editMas()"> Edit MAS </a>


              <a id ="closeBtn"  mat-flat-button color="accent"  (click)="onClose()"> Close </a>
          </div>
</div>
